/**
 * Custom Blogger Comments - Allow RTF in Blogger Comments
 *   Copyright (C) 2013  Daniele Corti - <daniele@corti.me>
 *
 *   This program is free software: you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program.  If not, see <http://www.gnu.org/licenses/>.  
 */

if(!this.cbc){this.cbc={}}this.cbc.AddEvent=function(a,c,b){if(a.attachEvent){a.attachEvent("on"+c,function(){b.call(a)})}else{if(a.addEventListener){a.addEventListener(c,b,false)}}};this.cbc.hasClass=function(b,a){return new RegExp("(\\s|^)"+a+"(\\s|$)").test(b.className)};if(!this.cbc.translations){this.cbc.translations=[]}this.cbc.applyTranslates=function(){if(document.getElementById&&document.getElementsByTagName){var a=document.getElementById("comments");var f=a.getElementsByTagName("p");for(var d=0;d<f.length;d++){var e=f[d];if(this.cbc.hasClass(e,"comment-content")){var c=e.innerHTML;for(var b=0;b<this.cbc.translations.length;b++){c=this.cbc.matchAndTranslate(c,this.cbc.translations[b])}e.innerHTML=c}}}};this.cbc.matchAndTranslate=function(e,g){if(!g){return e}var d=null,b=null;for(var c in g){d=c;b=g[c]}if(!d||!b||!b.call){return e}do{var f=new RegExp(d);var a=f.exec(e);e=b.call(this,e,a)}while(a!=null);return e};this.cbc.AddEvent(window,"load",this.cbc.applyTranslates);if(!this.cbc){this.cbc={}}if(!this.cbc.translations){this.cbc.translations=[]}this.cbc.translations.push({"\\[color=([\\w\\#]+)\\]":function(f,b){if(b==null){return f}var c=b.index;var e=b[0].length;var d=b[1];var a=f.substr(0,c);a+='<span style="color: '+d+'">';a+=f.substr(c+e);return a}});this.cbc.translations.push({"\\[\\/color\\]":function(e,b){if(b==null){return e}var c=b.index;var d=b[0].length;var a=e.substr(0,c);a+="</span>";a+=e.substr(c+d);return a}});